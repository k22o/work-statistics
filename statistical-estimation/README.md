# 統計推定
- 区間推定: 未知パラメータを一定の確率で含む区間を推定する。
- 点推定：未知パラメータを一つの値として推定する。

# 統計量
標本分布についての統計量を以下で定義する。
- 標本データ: $x$ 
- 標本平均: $\bar{X} = \frac{1}{n}\sum x_i$
- 標本分散 $S^2 = \frac{1}{n}\sum (x_i - \bar{x})^2 $ 
- 不偏標本分散 $s^2 = \frac{1}{n-1}\sum (x_i - \bar{x})^2 $ 

母集団分布の平均を $\mu$, 分散を $\sigma^2$ として、以下の関係性となる。
- $E(\bar{X}) = \mu$
- $V(\bar{X}) = \frac{\sigma^2}{n}  $
- $E(s^2) = \sigma^2$
- $V(S^2) = \frac{n-1}{n}\sigma^2  $


# 正規分布の区間推定
- 母集団は $N(\mu, \sigma)$ に従うとする。

## 各種分布の定義

| 分布 |　表記法  | 定義 | 前提 | 備考 | 
| ---- | ---- | ---- | ---- | ---- |
| カイ二乗分布  | $Y \sim \chi^2(k)$ | $$Y = \sum^k_{i=1} Z_i^2$$ | $z_i \sim N(0, 1)$ |　kを自由度と呼ぶ |
| t分布 | $Y \sim t(k)$ | $$t=\frac{X}{\sqrt{Y/k}}$$ |$X \sim N(0,1)$, $Y\sim \chi^2(k)$||
| F分布 | $F \sim F(k_1, k_2)$ | $$F=\frac{Y_1/k_1}{Y_2/k_2}$$ |$Y_1 \sim \chi^2(k_1)$, $Y_2 \sim \chi^2(k_2)$||


## 母平均 $\mu$ の推定
統計量 $Z \sim N(0,1)$ に対して $P(Z \geq z_\alpha) = \alpha$ を上側100 $\alpha$ %点と呼ぶ。<br>
逆に、正規分布の対称性から $P(-z_{\alpha/2} \leq Z \leq z_{\alpha/2}) = 1-\alpha$ が成り立つ。

標本平均は、前述の通り、以下の分布に従う。

$$\bar{X} \sim N(\mu, \frac{\sigma}{\sqrt{n}})$$

この基準化変量は、当然、標準正規分布となる。

$$ Z \equiv \frac{\bar{X} - \mu}{\sigma/ \sqrt{n}} \sim N(0, 1)$$

これをZとして代入することで、次の式を得る。

$$P(\bar{X} - z_{\alpha/2}\sqrt{\sigma^2/n} \leq \mu \leq \bar{X} + z_{\alpha/2}\sqrt{\sigma^2/n}) = 1 - \alpha$$

この区間、 $[\bar{X} \pm z_{\alpha/2}\sqrt{\sigma^2/n}]$　を、信頼係数 $100(1-\alpha)$%の区間とよび、上限下限を信頼上限信頼下限と呼ぶ。 


一般に、 $\mu$ も $\sigma$ も未知数である。ここでは、 $\mu$ を推定したいので、 $\sigma$ を既知の値である $s$ に置き換えて考える。
この値をt比 / Studnet比と呼ぶ。t比は、以下のt分布に従う。
(定義にそって変換すると、t分布の定義を満たすことがわかるはず。)

$$ \frac{\bar{X} - \mu}{s/\sqrt{n}} \sim t(n-1)$$

t分布も左右対称の分布をしており、上記と同様の議論がなりたち、

$$P(\bar{X} - t_{\alpha/2}(n-1)\sqrt{s^2/n} \leq \mu \leq \bar{X} + t_{\alpha/2}(n-1)\sqrt{s^2/n}) = 1 - \alpha$$

となる。ただし、 $t_{\alpha/2}(n-1)$ は、自由度 $n-1$ のt分布において、 $P(X \geq t_{\alpha/2}(n-1)) = \alpha/2$ となる値である。

## 母平均の差 $\mu_1-\mu_2$ の区間推定 
2つの統計量 $\bar{X} \sim N(\mu_1, \sigma^2_1/n_1), \bar{Y} \sim N(\mu_2, \sigma^2_2/n_2)$ について、以下が成り立つ。

$$ \bar{X} - \bar{Y} \sim N(\mu_1-\mu_2, \sigma^2_1/n_1 + \sigma^2_2/n_2)$$

正規分布にしたがうことから、基準化変量を考えれば、母平均の推定と同様にして、以下の信頼係数100(1-α)%の信頼区間を得る。

$$[(\bar{X} - \bar{Y}) \pm z_{\alpha/2}\sqrt{\sigma^2_1/n_1 + \sigma^2/n_2}]$$

次に、 $\sigma$ が未知として、 $s$ に置き替えることを考える。
母分散が共通ということを仮定すると、以下が成り立つ。　

$$ 
\begin{aligned}
\frac{(\bar{X} - \bar{Y}) - (\mu_1 - \mu_2)}{s\sqrt{1/n_1+1/n_2}} \sim t(n_1 + n_2 -2)\\
s = \sqrt{\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1+n_2-2}}
\end{aligned}
$$

この左辺は、2標本におけるt比と呼ばれる。<br>
ゆえに、同様にして、$\mu_1-\mu_2$ の信頼係数100(1-α)%の信頼区間を得る。

$$[(\bar{X} - \bar{Y}) \pm t_{\alpha/2}(n_1+n_2-2)s\sqrt{1/n_1 + 1/n_2}]$$

## 母分散 $\sigma^2$ の区間推定
不偏分散に関して、以下の性質が成り立つことが知られている。

$$ Y \equiv \frac{(n-1)s^2}{\sigma^2} ~ \sim \chi^2(n-1)$$

一般的なカイ二乗分布の性質として、

$$ P(Y > \chi^2_{\alpha}(k)) = \alpha $$

$$ P(\chi^2_{1-\alpha/2}(k) \leq Y \leq \chi^2_{\alpha/2}(k)) = 1 - \alpha$$

であり、Yに値を代入すると、以下が母分散$\sigma^2$に関数する信頼係数100(1-α)%の信頼区間となる。

$$ [\frac{(n-1)s^2}{\chi^2_{\alpha/2}(n-1)}, \frac{(n-1)s^2}{\chi^2_{1-\alpha/2}(n-1)}] $$

## 母分散 が等しいかどうかの検定
2つの標本の母分散が等しいかの検定は、以下の値を用いて行う。

$$
    \frac{s_1^2/\sigma_1^2}{s_2^2/\sigma_2^2} \sim F(n_1-1, n_2-1)
$$

母分散が等しいなら、 $\sigma_1^2 = \sigma_2^2$ として、

$$
    \frac{s_1^2}{s_2^2} \sim F(n_1-1, n_2-1)
$$


## 母比率の検定
標本比率を $\bar{p}$、母比率を $p$ とおく。このとき、nが十分大きい場合には、以下が成り立つ。あとは一般的なZ検定を行う。

$$
\bar{p} \sim N(p, \sqrt{\frac{p(1-p)}{n}})
$$

母比率の差については、以下のような分布に従う。

$$
\bar{p_1}-\bar{p_2} \sim N(p1 - p2, \sqrt{\frac{p_1(1-p_1)}{n_1} + \frac{p(1-p_1)}{n_1}})
$$


# 正規分布以外の区間推定
母数が多ければ、中心極限定理から、同様にして区間推定が可能である。導出は上記に同じのため、省略。

## 点推定
あるパラメータの値を直接推定する方法を、点推定と呼ぶ。

### モーメント法
複雑なモデルにおいては、どういったパラメータを求めるべきなのか定かではない場合がある。すなわち、上記のように、平均や分散に関するパラメータを決め撃ちできない。そういった場合には、モーメント法や最尤推定などが利用される。

$\alpha$ に関数する $n$ 次モーメントは次で定義される

$$ M_X^n(\alpha) = \int_{-\infin}^{\infin} (x-\alpha)^np(x)dx $$


母モーメント ( $\mu_k = E(X^k)$ ) を標本モーメント ( $m_k = \frac{1}{n}\sum X_i^k$ ) をもとに推定する。<br>
k=1の場合、以下のようになる。

$$ M_X^1(0) = \frac{1}{n}\sum X_i^k $$

これは、平均を推定することと同義となった。<br>
k=2の場合、以下のように平均周りのモーメントを考えることで、分散が推定できる。すなわち、

$$ 
\sigma^2 = \mu^{\prime}_2 = M_X^2(\bar{X}) = \frac{1}{n}\sum (X_i - \bar{X})^2 
$$

となる。
不偏推定量の考え方では、母分散は不偏分散になるのと、結果が異なっている。


### 最尤法
サブディレクトリ内を参照。
