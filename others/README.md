# その他トピックス

## 欠測値の取り扱い
欠測値が存在する**不完全**なデータの場合は、どうにかして**疑似完全**なデータにする必要がある。  
データを $(x,y)$ とすると、欠測メカニズムは以下の3つに分類される
- MCAR: $(x,y)$ の値に関わらず、ランダムで欠測が生じる。平均については、
- MAR: $x$ に依存して欠測が生じる (e.g. $x$ が大きいものが欠測)
- MNAR: $y$ に依存して欠測が生じる (e.g. $y$ が大きいものが欠測)。補完方法は、値の欠測の仕方によってCase By Case判断する。

データの処理は以下2つに大別される。
- 削除法: 欠損データはないものとして進める
   - CC (complete Case) 解析: 多変量 $x$ の全ての値が揃っているもののみ利用する
   - AC (Available Case) 解析: 多変量 $x$ のうち、一部が欠けている場合、その値を用いる解析でのみ除外する。

- 補完法: 欠損データを補完して進める
   - 平均値法: 平均値 $\bar{y}$ で補完
   - 回帰法: 回帰で予測した値 $\hat{y}$ で補完
   - Hot Deck法: 欠測データ $x_1$ とに類似したデータ $(x_2, y_2)$ を探してその $y_2$ の値で補完する

なお、補完法と欠測メカニズムの関係はいかの通り。
MCARは、補完するよりも削除法 (CC解析) の方がよい場合が多い。

|||MCAR|MAR|
|---|---|---|---|
|平均法|平均|概ね正しい|過小評価|
|  |標準偏差|過小評価|とても過小評価 (相関は過大に)|
|回帰法|平均|概ね正しい|概ね正しい|
|  |標準偏差|過小評価|やや過小評価 (相関は過大に)|

## 情報量基準
モデルにおける最大尤度を $L$ , 推定するパラメータを $k$、サンプル数を $n$ として、
- AIC (赤池情報量モデル): $-2\log L+2k$
- BIC (ベイズ情報量モデル): $-2\log L+k\log n$

## Bootstrap法
サンプル $X = \{x_1, x_2, ..., x_n\}$ があり、これから 
$\hat{\theta}(X)$ という推定値を得ることを考える。  
ブートストラップ法は、 $X$ からn個の要素を非復元抽出して (リサンプリング)、 $X^* = \{x^\*_1, x^\*_2, ..., x^\*_n\}$ というデータ (bootstrap標本) を得て、推定値 $\hat{\theta}(X^\*)$ を計算できる。

これをB回繰り返し、 $\hat{\theta}_i(X^*) (i=1,2,...B)$ から、ブートストラップ法によって以下のように推定値を求める。
上から、「推定値」「標準誤差のブートストラップ推定量」「バイアスのブートストラップ推定量」と呼ぶ。

$$
\begin{aligned}
\bar{\hat{\theta}}^\* &= \frac{1}{B}\sum^B_{i=0} \hat{\theta}^\*_i \\
s(X) &= \sqrt{\frac{1}{B-1}\sum(\hat{\theta}^\*_i -\bar{\hat{\theta}^\*})^2} \\
 bias &= \bar{\hat{\theta}}^\* - \hat{\theta} \\
\end{aligned}
$$

確率分布関数は、以下で求まる。

$$
Pr(\bar{X}\leq x) = \frac{1}{B} (x \leq \bar{x}_i の個数) 
$$


## Jackknife法
サンプル $X = \{x_1, x_2, ..., x_n\}$ があり、これから 
$\hat{\theta}(X)$ という推定値を得ることを考える。  
このうち、 $x_i$ を除いた $n-1$ 個のサンプルから、 $\hat{\theta}_i(X^*)$ を得る。これを $i=1,2,...,n$ まで繰り返す。
上から、「推定値」「標準誤差のジャックナイフ推定量」「バイアスのジャックナイフ推定量」と呼ぶ。

$$
\begin{aligned}
\bar{\hat{\theta}}^\* &= \frac{1}{n}\sum^n_{i=0} \hat{\theta}^\*_j \\
s(X) &= \sqrt{\frac{n-1}{n}\sum(\hat{\theta}^\*_j -\bar{\hat{\theta}^\*})^2} \\
bias &= (n-1)(\bar{\hat{\theta}}^\* - \hat{\theta}) \\
\end{aligned}
$$
